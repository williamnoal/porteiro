<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>O Porteiro do Condomínio dos Monstros</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Creepster&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            overflow: hidden;
        }
        .font-creepster {
            font-family: 'Creepster', cursive;
        }
        .intercom-btn.ringing {
            animation: ring-animation 1s infinite;
        }
        @keyframes ring-animation {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px #fde047; }
            50% { transform: scale(1.05); box-shadow: 0 0 20px #fde047; }
        }
        .task-option {
            transition: all 0.2s ease-in-out;
        }
        .task-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .intercom-img {
            height: 60px;
            width: 60px;
            object-fit: cover;
            border-radius: 50%;
            margin: 0 auto 8px auto;
            background-color: #334155;
            border: 2px solid #4f46e5;
        }
        .task-img {
            height: 120px;
            width: 120px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 1rem;
            background-color: #1e293b;
             border: 4px solid #a855f7;
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #4a044e; }
        ::-webkit-scrollbar-thumb { background: #a21caf; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #be185d; }
    </style>
</head>
<body class="bg-purple-900 bg-gradient-to-br from-gray-900 via-purple-900 to-slate-800 text-white min-h-screen flex items-center justify-center p-4">

    <!-- Main Game Container -->
    <div id="game-container" class="w-full max-w-7xl h-[95vh] bg-slate-800/50 backdrop-blur-sm rounded-2xl shadow-2xl shadow-purple-500/20 flex flex-col md:flex-row overflow-hidden border-2 border-purple-500/30">

        <!-- Left Panel: The Porter's Desk -->
        <div class="w-full md:w-1/3 lg:w-1/4 bg-slate-900/60 p-6 flex flex-col justify-between border-r-2 border-purple-500/30 overflow-y-auto">
            <div>
                <h1 class="font-creepster text-4xl text-center text-yellow-300 drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)]">Portaria</h1>
                <p class="text-center text-purple-300 mb-6">Condomínio dos Monstros</p>
                
                <div id="porter-info" class="text-center bg-slate-800/50 p-4 rounded-lg mb-4">
                    <!-- Imagem do Zé Chico aqui -->
                    <img src=zechico.jpg class="w-24 h-24 rounded-full mx-auto mb-3 border-4 border-purple-400">
                    <p class="font-bold text-lg">Porteiro: Zé Chico</p>
                    <p class="text-sm text-purple-300">Turno da Noite</p>
                </div>
                
                <div id="game-stats" class="text-center bg-slate-800/50 p-4 rounded-lg">
                     <p class="font-bold text-xl">Problemas Resolvidos: <span id="score" class="text-green-400">0</span></p>
                     <p class="text-sm mt-2">Chamados restantes: <span id="calls-left" class="text-yellow-400 font-bold">10</span></p>
                </div>
            </div>

            <div class="flex flex-col space-y-3 mt-6">
                <button id="help-button" class="w-full bg-purple-600 hover:bg-purple-700 font-bold py-2 px-4 rounded-lg shadow-lg transform hover:scale-105 transition-transform">Manual do Porteiro</button>
            </div>
        </div>

        <!-- Right Panel: Intercom and Task Area -->
        <div class="flex-1 flex flex-col p-6 overflow-y-auto">
            <!-- Intercom Panel -->
            <div id="intercom-panel" class="mb-6">
                <h2 class="font-creepster text-3xl text-center text-yellow-300 mb-4">Interfone</h2>
                <div id="intercom-buttons" class="grid grid-cols-3 sm:grid-cols-5 gap-4">
                    <!-- Intercom buttons will be dynamically generated here -->
                </div>
            </div>

            <!-- Task Area -->
            <div id="task-area" class="flex-1 bg-slate-900/50 rounded-xl p-6 flex flex-col items-center justify-center text-center">
                <div id="welcome-screen">
                    <h2 class="font-creepster text-5xl text-green-400 mb-4">Bem-vindo, Zé Chico!</h2>
                    <p class="text-lg mb-6 max-w-md mx-auto">Seu turno no Condomínio dos Monstros começou. Fique atento ao interfone! Serão 10 chamados esta noite.</p>
                    <button id="start-button" class="bg-green-600 hover:bg-green-700 font-bold py-3 px-8 rounded-lg shadow-lg text-2xl transform hover:scale-105 transition-transform">Começar o Turno</button>
                </div>
                <div id="task-display" class="hidden w-full h-full flex flex-col items-center justify-center">
                    <!-- Task content will be injected here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="help-modal" class="fixed inset-0 bg-black/80 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-slate-800 border-2 border-purple-500 rounded-2xl shadow-2xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto">
            <h2 class="font-creepster text-4xl text-yellow-300 mb-4">Manual do Porteiro</h2>
            <div id="help-content" class="text-purple-200 space-y-4">
                <p>Ser porteiro aqui não é fácil! Cada morador tem sua mania. Aqui estão algumas dicas:</p>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>Mula sem Cabeça (Apto. 101):</strong> Cuidado com o fogo e o coice! Ela se preocupa com suas ferraduras.</li>
                    <li><strong>Esqueleto (Apto. 201):</strong> Vive perdendo partes do corpo.</li>
                    <li><strong>Saci (Apto. 202):</strong> Adora pregar peças, como prender o elevador ou esconder coisas.</li>
                    <li><strong>Fantasma (Apto. 301):</strong> Gosta de assustar, mas é um bom sujeito. Às vezes perde suas correntes.</li>
                    <li><strong>Sr. Lupicínio (Apto. 302):</strong> Lobisomem gente boa, mas não se dá bem com gatos.</li>
                    <li><strong>Sra. B (Apto. 401):</strong> Bruxa de bom coração. Suas tortas podem ter efeitos... mágicos.</li>
                    <li><strong>Alienígena (Apto. 402):</strong> Seu disco-voador às vezes precisa de reparos com peças... incomuns.</li>
                    <li><strong>Conde Vlad (Apto. 501):</strong> Vampiro que só bebe sangue de galinha.</li>
                    <li><strong>Frank (Apto. 502):</strong> Cientista que precisa de itens estranhos para seus experimentos.</li>
                </ul>
            </div>
            <button id="close-help-button" class="mt-6 bg-purple-600 hover:bg-purple-700 font-bold py-2 px-6 rounded-lg shadow-lg w-full">Entendido!</button>
        </div>
    </div>
    
    <div id="end-game-modal" class="fixed inset-0 bg-black/80 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-slate-800 border-2 border-green-500 rounded-2xl shadow-2xl p-8 max-w-md w-full text-center">
            <h2 class="font-creepster text-5xl text-green-400 mb-4">Turno Encerrado!</h2>
            <p class="text-xl mb-6">Problemas resolvidos: <span id="final-score" class="font-bold text-2xl text-green-300"></span> / 10</p>
            <p id="end-game-message" class="text-purple-200 mb-6"></p>
            <button id="play-again-button" class="w-full bg-green-600 hover:bg-green-700 font-bold py-3 px-8 rounded-lg shadow-lg text-2xl transform hover:scale-105 transition-transform">Jogar Novamente</button>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- DATA ---
    const monsters = [
        { 
            id: 'mula', name: 'Mula s/ Cabeça', apartment: '101', sortOrder: 1, img src= 'mula.jpg',
            problems: [
                { id: 'mula1', description: "Zé, meu galope está meio esquisito. Acho que perdi uma ferradura no pátio. Você pode procurar?", options: [{ text: "Procurar perto do playground.", correct: true, feedback: "Achou! Ufa, agora posso galopar em paz. Obrigada!" }, { text: "Oferecer um sapato velho.", correct: false, feedback: "Um sapato? Onde eu colocaria isso?!" }]},
                { id: 'mula2', description: "A chama da minha cabeça está muito fraca hoje! Preciso de algo para avivá-la, mas que não seja água!", options: [{ text: "Usar um fole de lareira.", correct: true, feedback: "Isso! O ventinho ajudou a aumentar o fogo. Valeu!" }, { text: "Jogar um balde de areia.", correct: false, feedback: "Areia?! Você quer me apagar de vez?" }]}
            ]
        },
        { 
            id: 'esqueleto', name: 'Esqueleto', apartment: '201', sortOrder: 2, img src= 'esqueleto.jpg',
            problems: [
                { id: 'esk1', description: "*Som de ossos batendo* 'Or'eiro, 'ou eu! A'ei 'air meu ma'i'ar em a'gum 'u'ar 'or a'i!", options: [{ text: "Procurar perto do elevador.", correct: true, feedback: "A'ou! O'ri'a'o! A'ora 'on'i'o 'a'ar me'or!" }, { text: "Oferecer uma dentadura.", correct: false, feedback: "Nããão! 're'i'o 'o meu! É 'e osso de 'er'a'e!" }]},
                { id: 'esk2', description: "Olá, Zé! O Saci escondeu minha tíbia esquerda! Sem ela, eu ando todo torto. Você viu um osso comprido por aí?", options: [{ text: "Verificar no 'achados e perdidos'.", correct: true, feedback: "Estava aqui o tempo todo! Obrigado, Zé!" }, { text: "Sugerir que ele pule em um pé só.", correct: false, feedback: "Engraçadinho. Já tenho o Saci pra isso." }]}
            ]
        },
        { 
            id: 'saci', name: 'Saci', apartment: '202', sortOrder: 3, img src= 'saci.jpg,
            problems: [
                { id: 'saci1', description: "E aí, Zé! Hehehe. O elevador parou no meu andar de novo... que coisa, não? Alguém precisa tirar a fita adesiva do botão.", options: [{ text: "Subir de escada e tirar a fita.", correct: true, feedback: "Isso, vai lá! Hahaha! Cuidado pra não achar uma tachinha na sua cadeira depois..." }, { text: "Chamar o técnico do elevador.", correct: false, feedback: "Pra quê? É só um durex! Que falta de espírito esportivo!" }]},
                { id: 'saci2', description: "Psiu, Zé! Perdi meu gorro vermelho! Sem ele, perco meus poderes de redemoinho! Ele deve ter voado para o playground.", options: [{ text: "Procurar o gorro perto do escorrega.", correct: true, feedback: "Achou! Agora posso voltar a aprontar! Valeu!" }, { text: "Oferecer um boné.", correct: false, feedback: "Não é a mesma coisa! Preciso do meu gorro mágico!" }]}
            ]
        },
        { 
            id: 'fantasma', name: 'Fantasma', apartment: '301', sortOrder: 4, img src= 'fantasma.jpg',
            problems: [
                { id: 'fan1', description: "Buuuu... Porteiro... minhas correntes de estimação sumiram. Sem elas, não consigo fazer meu barulho de assombração direito.", options: [{ text: "Procurar as correntes na garagem.", correct: true, feedback: "Aqui estão elas! Obrigado! A noite de assombração está salva!" }, { text: "Sugerir que ele bata panelas.", correct: false, feedback: "Não tem o mesmo estilo... correntes são clássicas." }]},
                { id: 'fan2', description: "Preciso atravessar a parede para o apartamento do Frank, mas esqueci como se faz. Qual a palavra mágica?", options: [{ text: "Tentar 'Abra-te Sésamo'.", correct: false, feedback: "Essa é pra cavernas, não paredes. Buuuu..." }, { text: "Dizer a ele para se concentrar.", correct: true, feedback: "É mesmo! Concentração! *FWOOSH* Consegui! Valeu!" }]}
            ]
        },
        { 
            id: 'lupicinio', name: 'Sr. Lupicínio', apartment: '302', sortOrder: 5, img src= 'lupi.jpg',
            problems: [
                { id: 'lupo1', description: "Aaa-uuu... Zé! Aquele gato da Sra. B. não para de me provocar no playground! Faz alguma coisa!", options: [{ text: "Dar um novelo de lã ao gato.", correct: true, feedback: "Ufa, ele se distraiu! Obrigado, Zé! Você me salvou de um ataque de... fofura." }, { text: "Uivar de volta para o gato.", correct: false, feedback: "Ele só ficou mais irritado! E agora os outros cães da vizinhança responderam!" }]},
                { id: 'lupo2', description: "É noite de lua cheia e meu pelo está todo embaraçado! Preciso de uma escova bem grande.", options: [{ text: "Pegar uma escova de limpar chão.", correct: true, feedback: "Essa serve! Um pouco dura, mas vai funcionar! Aauuuu!" }, { text: "Oferecer um pente de bolso.", correct: false, feedback: "Isso vai quebrar no primeiro nó! Preciso de algo mais... parrudo." }]}
            ]
        },
        { 
            id: 'sra_b', name: 'Sra. B', apartment: '401', sortOrder: 6, img src= 'bruxa.jpg',
            problems: [
                { id: 'sra_b1', description: "Queridinho, é a Sra. B. Deixei uma torta aí para o Sr. Lupicínio. Por favor, guarde-a bem, o Bicho-Papão está com fome!", options: [{ text: "Guardar a torta na geladeira.", correct: true, feedback: "Ótimo, querido! Você salvou o presente (e a si mesmo). Obrigada!" }, { text: "Comer um pedacinho.", correct: false, feedback: "NÃO! É para o aniversariante! E você poderia dormir por seis meses!" }]},
                { id: 'sra_b2', description: "Meu caldeirão não quer acender! A lenha mágica acabou. Tem algum jornal velho aí para queimar?", options: [{ text: "Dar a página de esportes.", correct: true, feedback: "Perfeito! A vitória do time alvipúrpura vai dar um gosto especial à poção!" }, { text: "Sugerir usar um isqueiro.", correct: false, feedback: "Não, não, precisa de papel para começar o fogo mágico, querido." }]}
            ]
        },
        { 
            id: 'alien', name: 'Alienígena', apartment: '402', sortOrder: 7, img src= 'alien.jpg',
            problems: [
                { id: 'alien1', description: "Saudações, terráqueo. A bateria do meu disco-voador está baixa. Preciso recarregar na torre do prédio, mas tem um ninho de pombos lá.", options: [{ text: "Oferecer grãos para atrair os pombos para outro lugar.", correct: true, feedback: "Lógica eficiente. As criaturas foram realocadas. Grato." }, { text: "Sugerir que ele use um cabo de extensão.", correct: false, feedback: "Negativo. A voltagem da sua rede elétrica é primitiva." }]},
                { id: 'alien2', description: "Minha planta de estimação de Marte está murcha. Ela só bebe líquidos com alto teor de ferro... como... o sangue da galinha do Vlad.", options: [{ text: "Pedir um pouco para o Conde Vlad.", correct: true, feedback: "Comunicação interespécies bem-sucedida. A planta agradece." }, { text: "Oferecer água da torneira.", correct: false, feedback: "Sua água é... insípida. Não possui os nutrientes necessários." }]}
            ]
        },
        { 
            id: 'vlad', name: 'Conde Vlad', apartment: '501', sortOrder: 8, img src= 'vlad.jpg',
            problems: [
                { id: 'vlad1', description: "Zé Chico, meu bom homem, os bebedouros dos meus... 'pássaros'... estão vazios. Eles estão com uma sede terrível!", options: [{ text: "Comprar sangue de galinha.", correct: true, feedback: "Perfeito! Você tem futuro neste emprego, meu rapaz." }, { text: "Oferecer suco de uva.", correct: false, feedback: "A cor é parecida, mas o sabor... nem de longe. Não, obrigado." }]},
                { id: 'vlad2', description: "Meu caixão novo é esplêndido, mas os ratos do Frank roeram o fio do meu som ambiente! Preciso de uma ratoeira.", options: [{ text: "Armar uma ratoeira perto da garagem.", correct: true, feedback: "Excelente! O silêncio da noite é bom, mas uma música clássica para dormir não tem preço." }, { text: "Adotar um gato para o prédio.", correct: false, feedback: "Um gato? De jeito nenhum! O Sr. Lupicínio teria um ataque!" }]}
            ]
        },
        { 
            id: 'frank', name: 'Frank', apartment: '502', sortOrder: 9, img src= 'frank.jpg',
            problems: [
                { id: 'frank1', description: "Porteiro! Aqui é o Frank. Minha última experiência precisa de um... componente biológico. Um órgão vital, entende?", options: [{ text: "Comprar um coração de boi.", correct: true, feedback: "Exato! Fresquinho, por favor. A ciência agradece!" }, { text: "Sugerir um coração de pelúcia.", correct: false, feedback: "Não tem a mesma... voltagem. Preciso de um de verdade." }]},
                { id: 'frank2', description: "Os ratinhos do meu laboratório fugiram com a página de esportes do seu jornal! Preciso dela para forrar a gaiola.", options: [{ text: "Pegar o jornal de volta dos ratos.", correct: true, feedback: "Conseguiu! Esses bichinhos são rápidos. Obrigado!" }, { text: "Oferecer a página de economia.", correct: false, feedback: "Eles não gostam. Dizem que os gráficos são deprimentes." }]}
            ]
        },
        {
            id: 'entrada', name: 'Entrada', apartment: 'Portão', sortOrder: 10, img src= 'capa.png',
            problems: [
                { id: 'ent1', description: "Carteiro falando! Entrega para o Conde Vlad! É uma caixa enorme, pesada e... tem um formato de caixão. Preciso de ajuda!", options: [{ text: "Ajudar o carteiro a levar até o elevador.", correct: true, feedback: "Ufa! Obrigado, Zé! Minhas costas agradecem." }, { text: "Dizer para ele deixar na calçada.", correct: false, feedback: "Não posso! É contra as regras dos Correios!" }]},
                { id: 'ent2', description: "Olá, gracinha! Somos as amigas da Sra. B. para a noite de receitas. Pode avisar que chegamos?", options: [{ text: "Interfonar para a Sra. B.", correct: true, feedback: "Obrigada, fofinho! Estamos subindo!" }, { text: "Pedir a receita do caldeirão.", correct: false, feedback: "É segredo de bruxa! Hehehe. Interfone pra ela, vai!" }]}
            ]
        }
    ];

    // --- GAME STATE ---
    let score = 0;
    let callsLeft = 10;
    let activeCall = null;
    let gameActive = false;
    let gameQueue = [];

    // --- DOM ELEMENTS ---
    const intercomButtonsContainer = document.getElementById('intercom-buttons');
    const taskArea = document.getElementById('task-area');
    const welcomeScreen = document.getElementById('welcome-screen');
    const taskDisplay = document.getElementById('task-display');
    const startButton = document.getElementById('start-button');
    const scoreDisplay = document.getElementById('score');
    const callsLeftDisplay = document.getElementById('calls-left');
    const helpButton = document.getElementById('help-button');
    const helpModal = document.getElementById('help-modal');
    const closeHelpButton = document.getElementById('close-help-button');
    const endGameModal = document.getElementById('end-game-modal');
    const finalScoreDisplay = document.getElementById('final-score');
    const endGameMessage = document.getElementById('end-game-message');
    const playAgainButton = document.getElementById('play-again-button');


    // --- FUNCTIONS ---

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function initGame() {
        score = 0;
        callsLeft = 10;
        activeCall = null;
        gameActive = false;
        gameQueue = [];
        
        updateStats();
        setupIntercom();

        taskDisplay.classList.add('hidden');
        welcomeScreen.classList.remove('hidden');
        endGameModal.classList.add('hidden');
        startButton.onclick = startGame;
    }

    function setupIntercom() {
        intercomButtonsContainer.innerHTML = '';
        const sortedMonsters = [...monsters].sort((a, b) => a.sortOrder - b.sortOrder);

        sortedMonsters.forEach(monster => {
            const button = document.createElement('button');
            button.id = `intercom-${monster.id}`;
            button.className = 'intercom-btn bg-slate-700 p-2 rounded-lg text-center transition-all duration-300 hover:bg-purple-700 disabled:bg-slate-800 disabled:text-gray-500 disabled:cursor-not-allowed shadow-md';
            button.disabled = true;
            button.innerHTML = `
                <img src="${monster.imageUrl}" alt="[Imagem de ${monster.name}]" class="intercom-img">
                <div class="font-bold text-sm">${monster.name}</div>
                <div class="text-xs text-purple-300">Apto. ${monster.apartment}</div>
            `;
            button.addEventListener('click', () => handleCall(monster.id));
            intercomButtonsContainer.appendChild(button);
        });
    }

    function startGame() {
        gameActive = true;
        welcomeScreen.classList.add('hidden');
        taskDisplay.classList.remove('hidden');
        
        // Create and shuffle the task queue for this game session
        const allProblems = monsters.flatMap(monster => 
            monster.problems.map(problem => ({ ...problem, monsterId: monster.id, monster: monster }))
        );
        shuffleArray(allProblems);
        gameQueue = allProblems.slice(0, 10);
        
        callsLeft = gameQueue.length;
        updateStats();

        taskDisplay.innerHTML = `<p class="text-2xl text-purple-300 animate-pulse">Aguardando chamados...</p>`;
        
        setTimeout(nextCall, 2000);
    }

    function nextCall() {
        if (!gameActive || activeCall) return;

        if (gameQueue.length === 0) {
            endGame();
            return;
        }

        const nextTask = gameQueue[0]; // Peek at the next task
        activeCall = nextTask;
        
        const button = document.getElementById(`intercom-${nextTask.monsterId}`);
        button.disabled = false;
        button.classList.add('ringing');

        taskDisplay.innerHTML = `<p class="text-2xl text-yellow-300 animate-pulse">O interfone de ${nextTask.monster.name} está tocando...</p>`;
    }

    function handleCall(monsterId) {
        if (!activeCall || activeCall.monsterId !== monsterId) return;

        const monster = activeCall.monster;
        const problem = activeCall;
        
        const button = document.getElementById(`intercom-${monsterId}`);
        button.classList.remove('ringing');
        document.querySelectorAll('.intercom-btn').forEach(btn => btn.disabled = true);

        taskDisplay.innerHTML = `
            <div class="w-full flex flex-col items-center">
                 <img src="${monster.imageUrl}" alt="[Imagem de ${monster.name}]" class="task-img">
                <h3 class="font-bold text-2xl text-yellow-300 mb-2">${monster.name} (Apto. ${monster.apartment}) diz:</h3>
                <p class="text-lg text-purple-200 mb-6 max-w-lg">"${problem.description}"</p>
                <div id="options-container" class="w-full max-w-lg grid grid-cols-1 gap-3">
                    ${problem.options.map(opt => `
                        <button class="task-option bg-purple-600 hover:bg-purple-500 p-4 rounded-lg shadow-md" data-correct="${opt.correct}" data-feedback="${opt.feedback}">
                            ${opt.text}
                        </button>
                    `).join('')}
                </div>
            </div>`;

        document.querySelectorAll('.task-option').forEach(optionButton => {
            optionButton.addEventListener('click', resolveTask);
        });
    }

    function resolveTask(event) {
        const selectedOption = event.currentTarget;
        const isCorrect = selectedOption.dataset.correct === 'true';
        const feedback = selectedOption.dataset.feedback;

        if (isCorrect) {
            score++;
            taskDisplay.innerHTML = `<div class="text-center"><h3 class="font-creepster text-4xl text-green-400 mb-4">Problema Resolvido!</h3><p class="text-lg">${feedback}</p></div>`;
        } else {
            taskDisplay.innerHTML = `<div class="text-center"><h3 class="font-creepster text-4xl text-red-500 mb-4">Ops!</h3><p class="text-lg">${feedback}</p></div>`;
        }
        
        gameQueue.shift(); // Remove the completed task from the queue
        callsLeft = gameQueue.length;
        updateStats();
        
        activeCall = null;
        document.querySelectorAll('.intercom-btn').forEach(btn => btn.disabled = true);
        
        setTimeout(() => {
            if (callsLeft > 0) {
                 taskDisplay.innerHTML = `<p class="text-2xl text-purple-300 animate-pulse">Aguardando chamados...</p>`;
                 nextCall();
            } else {
                endGame();
            }
        }, 3000);
    }

    function endGame() {
        gameActive = false;
        finalScoreDisplay.textContent = score;
        let message = "";
        if (score >= 8) {
            message = "Incrível! Você é o porteiro do mês! Todos os monstros estão felizes (e em paz, por enquanto).";
        } else if (score >= 5) {
            message = "Bom trabalho! Você sobreviveu à noite com apenas alguns sustos. Os monstros te respeitam.";
        } else {
            message = "Foi por pouco! Algumas confusões aconteceram, mas você ainda tem seu emprego. Tente de novo para impressionar o Conde Vlad!";
        }
        endGameMessage.textContent = message;
        endGameModal.classList.remove('hidden');
    }

    function updateStats() {
        scoreDisplay.textContent = score;
        callsLeftDisplay.textContent = callsLeft;
    }

    // --- EVENT LISTENERS ---
    helpButton.addEventListener('click', () => helpModal.classList.remove('hidden'));
    closeHelpButton.addEventListener('click', () => helpModal.classList.add('hidden'));
    playAgainButton.addEventListener('click', initGame);

    // --- INITIALIZATION ---
    initGame();
});
</script>

</body>

</html>

